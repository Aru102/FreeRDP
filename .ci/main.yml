name: $(Date:yyyyMMdd)$(Rev:-rr)

pool:
  vmImage: 'windows-2022'
  demands:
  - msbuild
  - visualstudio

steps:
- task: NuGetToolInstaller@1
  displayName: 'Use NuGet'

- task: NuGetAuthenticate@0

- task: NuGetCommand@2
  displayName: restore
  inputs:
    command: 'restore'
    restoreSolution: 'UiPath.FreeRdpClient\UiPath.SessionTools.sln'

- task: MSBuild@1
  displayName: build
  inputs:
    solution: 'UiPath.FreeRdpClient\UiPath.SessionTools.sln' 
    configuration: 'Release'
    msbuildArguments: "/p:VersionSuffix=$(Build.BuildNumber)"

- task: DotNetCoreCLI@2
  displayName: 'test'
  inputs:
    command: 'test'
    configuration: 'Release'
    arguments: '--no-build --configuration Release'
    projects: 'UiPath.FreeRdpClient\**\*.Tests.csproj'
